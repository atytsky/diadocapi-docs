Пакет документов
================

**Пакет документов** — несколько связанных между собой документов, предназначенных одному контрагенту. В пакет можно объединить документы из разных :doc:`сообщений <../entities/message>`.

Пакеты бывают следующих типов:

- **Открытый пакет**: в таком пакете документы можно обрабатывать по отдельности. Состав пакета можно изменить.

- **Закрытый пакет**: в таком пакете с документами нельзя работать по отдельности: действие должно быть применено сразу ко всем документам. Состав пакета изменить нельзя. 
  
  Для закрытого пакета существуют :doc:`режимы блокировки <../proto/LockMode>`, которая распространяется на следующие действия:
  
	- подписание,
	- отказ в подписи,
	- перемещение,
	- удаление,
	- восстановление,
	- согласование,
	- аннулирование,
	- создание исходящего документа из документа-шаблона,
	- отклонение и отзыв документа-шаблона.

При отправке методом :doc:`../http/PostMessage` документы автоматически формируют пакет. Каждому пакету присваивается идентификатор ``PacketId``. Чтобы добавить документ в уже существующий пакет, при отправке укажите у него ``SubordinateDocumentId`` или ``InitialDocumentId``.

	- ``SubordinateDocumentId`` — идентификатор документа, который должен ссылаться на отправляемый документ.
	- ``InitialDocumentId`` — идентификатор документа, к которому привязывается отправляемый документ.

Документ можно добавить в новый пакет после отправки. Если добавляемый документ является частью другого пакета, то в новый пакет будут добавлены все документы из старого пакета — пакеты объединяются целиком. В этом случае документу будет присвоен ``PacketId`` нового пакета. Если объединить документы из разных пакетов, то новому пакету будет присвоен новый ``PacketId``. При удалении документа из пакета ``PacketId`` меняется на новый.

Представление в API
-------------------

*Методы для работы с пакетами:*
 - :doc:`../http/GetDocflowsByPacketId_V3` — возвращает список документов, находящихся в пакете.

*Структуры для работы с пакетами:*
 - :doc:`../proto/PacketInfo` — хранит информацию о связанных документах.
 - :doc:`../proto/LockMode` — представляет собой режим блокировки сообщения с документами.
 - :ref:`EditDocumentPacketCommand` — представляет собой действие по редактированию состава пакета одного из документов в сообщении.