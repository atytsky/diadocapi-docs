ShelfUpload
===========

Метод ``ShelfUpload`` загружает фрагмент содержимого документа на :doc:`полку документов<../entities/shelf>`.

.. http:post:: /ShelfUpload

	:queryparam nameOnShelf: имя документа на :doc:`полке документов <../entities/shelf>`.
	:queryparam partIndex: номер загружаемого фрагмента документа. Фрагменты индексируются с 0.
	:queryparam isLastPart: признак того, что загружается последний фрагмент документа. Для последнего фрагмента должен быть равен 1, для остальных может отсутствовать или быть равным 0.

	:requestheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`.
	
	:request Body: Тело запроса должно содержать бинарные данные, представляющие собой фрагмент содержимого.

	:statuscode 200: операция успешно завершена.
	:statuscode 400: данные в запросе имеют неверный формат или отсутствуют обязательные параметры.
	:statuscode 403: доступ к ящику с предоставленным авторизационным токеном запрещен.
	:statuscode 500: при обработке запроса возникла непредвиденная ошибка.

Для выполнения метода текущий пользователь должен быть авторизован в Диадоке, иначе метод вернет ошибку ``403 (Forbidden)``.

При загрузке документа укажите в параметре ``nameOnShelf`` его будущее имя на полке. Вы можете загрузить документ в локальное или публичное :ref:`пространство имен полки<shelf_namespaces>`.

Чтобы загрузить документ на полку, разделите его бинарное содержимое на части и загрузите каждую часть отдельным вызовом метода ``ShelfUpload``.

.. note::
	Размер каждой загружаемой части содержимого не должен превышать 70 Мб.

Последнюю часть документа загрузите с параметром ``isLastPart = 1``: это сообщит серверу, что вы загрузили все части документа. В ответе метод сообщит, все ли части были загружены успешно.

Если при загрузке каких-то частей документа произошли ошибки, то метод вернет в теле ответа список номеров этих частей в формате JSON. Загрузите эти части повторно. 

Если документ загружен полностью, то он становится доступным для чтения с полки документов, и его имя можно указать в поле ``NameOfShelf`` структур :doc:`../proto/SignedContent` и :doc:`../proto/UnsignedContent`.

----

.. rubric:: Смотри также

*Руководства:*
	- :doc:`../entities/shelf`

*Другие методы для работы с полкой документов:*
	- :doc:`ShelfDownload` — загружает данные с полки.